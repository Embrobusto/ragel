lex start
{
	ignore /[ \t]+/
	literal '*', '(', ')', '^', ';', '\n'
	token id /[a-zA-Z_]+/
}

parser out_parser [out]
global out_parser Out = construct out_parser []

def out_item
	[id]
|	['(' item* ')']

def out 
	[out_item*]

def item 
	[id]
	{
		Out << r1
	}
|	['(' item* ')']
	{
		Out << '('
		Out << r2
		Out << ')'
	}

def A1 []
def A2 []


def start 
	[A1 item* '^']
|	[A2 item* ';' '\n']

start Input = parse start( stdin )
print( Input )
