namespace r1
{
	lex
	{
		literal '!', 'a', 'b'
		ignore /[ \n\t]+/
	}

	def line [ '!' 'a' 'b' 'b' 'a']
}

namespace r2
{
	lex
	{
		literal '!'
		token id /[a-zA-Z_]+/
		ignore /[ \n\t]+/
	}

	def line [ '!' id ]
}

def item 
	[r1::line]
|	[r2::line]

def btscan 
	[item*]

cons Parser: parser<btscan> []

send Parser "!ab"
send Parser "b "
send Parser "!ab"
send Parser "ba !aab\n"

print_xml( Parser() )
